{"name": "tensorflow", "cve_id": "CVE-2020-26267", "publish_date": "2020-12-10T23:15Z", "cwe_id": "CWE-125", "owner": "Google Inc.", "affected_versions": [{"version_value": "1.15.5", "operator": "<"}, {"version_value": "2.0.0", "operator": "="}, {"version_value": "2.0.1", "operator": "="}, {"version_value": "2.0.2", "operator": "="}, {"version_value": "2.0.3", "operator": "="}, {"version_value": "2.1.0", "operator": "="}, {"version_value": "2.1.1", "operator": "="}, {"version_value": "2.1.2", "operator": "="}, {"version_value": "2.2.0", "operator": "="}, {"version_value": "2.2.1", "operator": "="}, {"version_value": "2.3.0", "operator": "="}, {"version_value": "2.3.1", "operator": "="}], "references": ["https://nvd.nist.gov/vuln/detail/CVE-2020-26267", "https://github.com/advisories/GHSA-c9f3-9wfr-wgh7", "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-c9f3-9wfr-wgh7", "https://github.com/tensorflow/tensorflow/commit/ebc70b7a592420d3d2f359e4b1694c236b82c7ae"], "description": "From NVD:\nIn affected versions of TensorFlow the tf.raw_ops.DataFormatVecPermute API does not validate the src_format and dst_format attributes. The code assumes that these two arguments define a permutation of NHWC. This can result in uninitialized memory accesses, read outside of bounds and even crashes. This is fixed in versions 1.15.5, 2.0.4, 2.1.3, 2.2.2, 2.3.2, and 2.4.0.\nFrom Github:\n### Impact\nThe `tf.raw_ops.DataFormatVecPermute` API does not validate the `src_format` and `dst_format` attributes. [The code](https://github.com/tensorflow/tensorflow/blob/304b96815324e6a73d046df10df6626d63ac12ad/tensorflow/core/kernels/data_format_ops.cc) assumes that these two arguments define a permutation of `NHWC`.\n\nHowever, these assumptions are not checked and this can result in uninitialized memory accesses, read outside of bounds and even crashes.\n\n```python\n>>> import tensorflow as tf\n>>> tf.raw_ops.DataFormatVecPermute(x=[1,4], src_format='1234', dst_format='1234')\n\n...\n>>> tf.raw_ops.DataFormatVecPermute(x=[1,4], src_format='HHHH', dst_format='WWWW')\n\n...\n>>> tf.raw_ops.DataFormatVecPermute(x=[1,4], src_format='H', dst_format='W')\n\n>>> tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4], \n src_format='1234', dst_format='1253')\n\n...\n>>> tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4],\n src_format='1234', dst_format='1223')\n\n...\n>>> tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4],\n src_format='1224', dst_format='1423')\n\n...\n>>> tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4], src_format='1234', dst_format='432')\n\n...\n>>> tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4],\n src_format='12345678', dst_format='87654321')\nmunmap_chunk(): invalid pointer\nAborted\n...\n>>> tf.raw_ops.DataFormatVecPermute(x=[[1,5],[2,6],[3,7],[4,8]], \n src_format='12345678', dst_format='87654321')\n\n...\n>>> tf.raw_ops.DataFormatVecPermute(x=[[1,5],[2,6],[3,7],[4,8]], \n src_format='12345678', dst_format='87654321')\nfree(): invalid next size (fast)\nAborted\n```\n\nA similar issue occurs in `tf.raw_ops.DataFormatDimMap`, for the same reasons:\n\n```python\n>>> tf.raw_ops.DataFormatDimMap(x=[[1,5],[2,6],[3,7],[4,8]], src_format='1234',\n>>> dst_format='8765')\n\n```\n\n### Patches\nWe have patched the issue in GitHub commit [ebc70b7a592420d3d2f359e4b1694c236b82c7ae](https://github.com/tensorflow/tensorflow/commit/ebc70b7a592420d3d2f359e4b1694c236b82c7ae) and will release TensorFlow 2.4.0 containing the patch. TensorFlow nightly packages after this commit will also have the issue resolved.\n\nSince this issue also impacts TF versions before 2.4, we will patch all releases between 1.15 and 2.3 inclusive.\n\n### For more information\nPlease consult [our security guide](https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.", "latest_version": "2.3.1", "language": "python", "license": "Apache-2.0", "repository_summary": "TensorFlow is an open source machine learning framework for everyone.", "repo_url": "https://github.com/tensorflow/tensorflow", "impact": {"cvss2_score": 4.3, "cvss2_severity": "MEDIUM", "av": "LOCAL", "ac": "LOW", "pr": "LOW", "c": "HIGH", "i": "HIGH", "a": "HIGH", "impact_score": 5.9, "exploitability_score": 1.8, "cvss3_score": 7.8, "cvss3_severity": "HIGH", "ui": "NONE", "s": "UNCHANGED"}, "ochrona_severity_score": 7.8}