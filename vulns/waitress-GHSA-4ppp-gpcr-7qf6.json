{"name": "waitress", "cve_id": "GHSA-4ppp-gpcr-7qf6", "publish_date": "2019-12-20T23:04:35Z", "cwe_id": "CWE-400", "owner": "Zope Foundation and Contributors", "affected_versions": [{"version_value": "1.3.1", "operator": "<"}], "references": ["https://github.com/Pylons/waitress/security/advisories/GHSA-4ppp-gpcr-7qf6", "https://github.com/advisories/GHSA-4ppp-gpcr-7qf6"], "description": "### Impact\n\nWaitress would header fold a double `Content-Length` header and due to being unable to cast the now comma separated value to an integer would set the `Content-Length` to 0 internally.\n\nSo a request with:\n\n```\nContent-Length: 10\nContent-Length: 10\n```\n\nwould get transformed to:\n\n```\nContent-Length: 10, 10\n```\n\nWhich would Waitress would then internally set to `Content-Lenght: 0`.\n\nWaitress would then treat the request as having no body, thereby treating the body of the request as a new request in HTTP pipelining.\n\n### Patches\n\nThis issue is fixed in Waitress 1.4.0. This brings a range of changes to harden Waitress against potential HTTP request confusions, and may change the behaviour of Waitress behind non-conformist proxies. \n\nThe Pylons Project recommends upgrading as soon as possible, while validating that the changes in Waitress don't cause any changes in behavior.\n\n### Workarounds\n\nVarious reverse proxies may have protections against sending potentially bad HTTP requests to the backend, and or hardening against potential issues like this. If the reverse proxy doesn't use HTTP/1.1 for connecting to the backend issues are also somewhat mitigated, as HTTP pipelining does not exist in HTTP/1.0 and Waitress will close the connection after every single request (unless the Keep Alive header is explicitly sent... so this is not a fool proof security method).\n\n### Issues/more security issues:\n\n* open an issue at https://github.com/Pylons/waitress/issues (if not sensitive or security related)\n* email the Pylons Security mailing list: pylons-project-security@googlegroups.com (if security related)", "latest_version": "1.4.4", "language": "python", "license": "ZPL-2.1", "repository_summary": "Waitress WSGI server", "repo_url": "https://github.com/Pylons/waitress", "impact": {"cvss3_score": null, "cvss3_severity": null, "av": null, "ac": null, "pr": null, "ui": null, "s": null, "c": null, "i": null, "a": null, "impact_score": null, "exploitability_score": null}, "ochrona_severity_score": 9}