{
    "name": "Flask-Security-Too",
    "cve_id": "CVE-2021-21241",
    "publish_date": "2021-01-11T21:15Z",
    "cwe_id": "CWE-352",
    "owner": "Matt Wright & Chris Wagner",
    "affected_versions": [
        {
            "version_value": "3.3.0rc1",
            "operator": "="
        },
        {
            "version_value": "3.3.0rc2",
            "operator": "="
        },
        {
            "version_value": "3.3.0rc3",
            "operator": "="
        },
        {
            "version_value": "3.3.0",
            "operator": "="
        },
        {
            "version_value": "3.3.1",
            "operator": "="
        },
        {
            "version_value": "3.3.2",
            "operator": "="
        },
        {
            "version_value": "3.3.3",
            "operator": "="
        },
        {
            "version_value": "3.4.0",
            "operator": "="
        },
        {
            "version_value": "3.4.1",
            "operator": "="
        },
        {
            "version_value": "3.4.2",
            "operator": "="
        },
        {
            "version_value": "3.4.3",
            "operator": "="
        },
        {
            "version_value": "3.4.4",
            "operator": "="
        }
    ],
    "references": [
        "https://pypi.org/project/Flask-Security-Too",
        "https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-hh7m-rx4f-4vpv",
        "https://github.com/Flask-Middleware/flask-security/commit/61d313150b5f620d0b800896c4f2199005e84b1f",
        "https://github.com/advisories/GHSA-hh7m-rx4f-4vpv",
        "https://github.com/Flask-Middleware/flask-security/commit/6d50ee9169acf813257c37b75babe9c28e83542a",
        "https://github.com/Flask-Middleware/flask-security/releases/tag/3.4.5",
        "https://nvd.nist.gov/vuln/detail/CVE-2021-21241",
        "https://github.com/Flask-Middleware/flask-security/pull/422"
    ],
    "description": "From NVD:\nThe Python \"Flask-Security-Too\" package is used for adding security features to your Flask application. It is an is a independently maintained version of Flask-Security based on the 3.0.0 version of Flask-Security. In Flask-Security-Too from version 3.3.0 and before version 3.4.5, the /login and /change endpoints can return the authenticated user's authentication token in response to a GET request. Since GET requests aren't protected with a CSRF token, this could lead to a malicious 3rd party site acquiring the authentication token. Version 3.4.5 and version 4.0.0 are patched. As a workaround, if you aren't using authentication tokens - you can set the SECURITY_TOKEN_MAX_AGE to \"0\" (seconds) which should make the token unusable.\nFrom Github:\n### Issue\nThe /login and /change endpoints can return the authenticated user's authentication token in response to a GET request. Since GET requests aren't protected with a CSRF token, this could lead to a malicious 3rd party site acquiring the authentication token.\n\n### Patches\nVersion 3.4.5 and soon to be released 4.0.0 are patched.\n\n### Workarounds\nIf you aren't using authentication tokens - you can set the SECURITY_TOKEN_MAX_AGE to \"0\" (seconds) which should make the token unusable.\n\n### References\nNone",
    "latest_version": "3.4.5",
    "language": "python",
    "license": "MIT",
    "repository_summary": "Simple security for Flask apps.",
    "repo_url": "https://github.com/Flask-Middleware/flask-security",
    "impact": {
        "cvss2_score": null,
        "cvss2_severity": null,
        "vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
        "av": "NETWORK",
        "ac": "LOW",
        "pr": "NONE",
        "c": "HIGH",
        "i": "NONE",
        "a": "NONE",
        "impact_score": 4.0,
        "exploitability_score": 2.8,
        "cvss3_score": 7.4,
        "cvss3_severity": "HIGH",
        "ui": "REQUIRED",
        "s": "CHANGED"
    },
    "ochrona_severity_score": 7.4
}