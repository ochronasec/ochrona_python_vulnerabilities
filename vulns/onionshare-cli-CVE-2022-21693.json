{
    "name": "onionshare-cli",
    "cve_id": "CVE-2022-21693",
    "publish_date": "2022-01-18T22:15Z",
    "cwe_id": "CWE-22",
    "owner": "Micah Lee",
    "affected_versions": [
        {
            "version_value": "2.5",
            "operator": "<"
        }
    ],
    "references": [
        "https://github.com/onionshare/onionshare/security/advisories/GHSA-jgm9-xpfj-4fq6",
        "https://nvd.nist.gov/vuln/detail/CVE-2022-21693",
        "https://github.com/onionshare/onionshare/releases/tag/v2.5",
        "https://github.com/advisories/GHSA-jgm9-xpfj-4fq6"
    ],
    "description": "From NVD:\nOnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions an adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced. This can be mitigated by usage of the flatpak release.\nFrom Github:\nBetween September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-013\n- Vulnerability type: Improper Hardening\n- Threat level: Low\n\n## Description:\n\nThe filesystem restriction could be hardened and should only allow for pre-defined subfolders.\n\n## Technical description:\n\nThe Flatpak and Snap configurations allow for read-only access on the whole home folder. The relevant lines in the configuration files are `onionshare/snap/snapcraft.yaml#L20` and `onionshare/flatpak/org.onionshare.OnionShare.yaml#L19` , respectively.\n\nThe encapsulation of filesystem access via these mechanisms should be restricted to pre-defined folders and not allow for access to (configuration) files outside the Onionshare-specific folders.\n\nSadly Snap does not allow for further restriction to specific folders and therefore cannot be further hardened. By default both frameworks disallow access to hidden folders and therefore reduce the potential impact.\n\n## Impact:\n\nAn adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced.\n\n## Recommendation:\n\n- Reduce read access in Flatpak configuration.",
    "latest_version": "2.5",
    "language": "python",
    "license": "GPL-3.0-or-later",
    "repository_summary": "OnionShare lets you securely and anonymously send and receive files. It works by starting a web server, making it accessible as a Tor onion service, and generating an unguessable web address so others can download files from you, or upload files to you. It does _not_ require setting up a separate server or using a third party file-sharing service.",
    "repo_url": "https://github.com/onionshare/onionshare",
    "impact": {
        "cvss2_score": 4.0,
        "cvss2_severity": "MEDIUM",
        "vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
        "av": "NETWORK",
        "ac": "LOW",
        "pr": "LOW",
        "c": "HIGH",
        "i": "NONE",
        "a": "NONE",
        "impact_score": 3.6,
        "exploitability_score": 2.8,
        "cvss3_score": 6.5,
        "cvss3_severity": "MEDIUM",
        "ui": "NONE",
        "s": "UNCHANGED"
    },
    "ochrona_severity_score": 6.5
}