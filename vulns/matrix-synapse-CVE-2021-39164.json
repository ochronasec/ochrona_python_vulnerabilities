{
    "name": "matrix-synapse",
    "cve_id": "CVE-2021-39164",
    "publish_date": "2021-08-31T17:15Z",
    "cwe_id": "CWE-200",
    "owner": "Matrix Authors",
    "affected_versions": [
        {
            "version_value": "1.41.1",
            "operator": "<"
        }
    ],
    "references": [
        "https://nvd.nist.gov/vuln/detail/CVE-2021-39164",
        "https://github.com/advisories/GHSA-3x4c-pq33-4w3q",
        "https://github.com/matrix-org/synapse/security/advisories/GHSA-3x4c-pq33-4w3q",
        "https://github.com/matrix-org/synapse/releases/tag/v1.41.1",
        "https://github.com/matrix-org/synapse/commit/cb35df940a"
    ],
    "description": "From NVD:\nMatrix is an ecosystem for open federated Instant Messaging and Voice over IP. In versions 1.41.0 and prior, unauthorised users can access the membership (list of members, with their display names) of a room if they know the ID of the room. The vulnerability is limited to rooms with `shared` history visibility. Furthermore, the unauthorised user must be using an account on a vulnerable homeserver that is in the room. Server administrators should upgrade to 1.41.1 or later in order to receive the patch. One workaround is available. Administrators of servers that use a reverse proxy could, with potentially unacceptable loss of functionality, block the endpoints: `/_matrix/client/r0/rooms/{room_id}/members` with `at` query parameter, and `/_matrix/client/unstable/rooms/{room_id}/members` with `at` query parameter.\nFrom Github:\n### Impact\nUnauthorised users can access the membership (list of members, with their display names) of a room if they know the ID of the room. The vulnerability is limited to rooms with `shared` history visibility. Furthermore, the unauthorised user must be using an account on a vulnerable homeserver that is in the room.\n\n### Patches\nServer administrators should upgrade to 1.41.1 or later.\n\n### Workarounds\nAdministrators of servers that use a reverse proxy could, with potentially unacceptable loss of functionality, block the following endpoints:\n* `/_matrix/client/r0/rooms/{room_id}/members` with `at` query parameter\n* `/_matrix/client/unstable/rooms/{room_id}/members` with `at` query parameter\n\n### References\nn/a\n\n### For more information\nIf you have any questions or comments about this advisory, e-mail us at security@matrix.org.",
    "latest_version": "1.30.1",
    "language": "python",
    "license": "Apache-2.0",
    "repository_summary": "Reference homeserver for the Matrix decentralised comms protocol",
    "repo_url": "https://github.com/matrix-org/synapse",
    "impact": {
        "cvss2_score": null,
        "cvss2_severity": null,
        "av": "NETWORK",
        "ac": "HIGH",
        "pr": "LOW",
        "c": "LOW",
        "i": "NONE",
        "a": "NONE",
        "impact_score": 1.4,
        "exploitability_score": 1.6,
        "cvss3_score": 3.1,
        "cvss3_severity": "LOW",
        "vector_string": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N",
        "ui": "NONE",
        "s": "UNCHANGED"
    },
    "ochrona_severity_score": 3.1
}