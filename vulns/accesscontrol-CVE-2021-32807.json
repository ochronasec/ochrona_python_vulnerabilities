{
    "name": "AccessControl",
    "cve_id": "CVE-2021-32807",
    "publish_date": "2021-07-30T22:15Z",
    "cwe_id": "CWE-94",
    "owner": "Zope Foundation and Contributors",
    "affected_versions": [
        {
            "version_value": "5.1",
            "operator": "="
        },
        {
            "version_value": "5.0",
            "operator": "="
        },
        {
            "version_value": "4.2",
            "operator": "="
        },
        {
            "version_value": "4.1",
            "operator": "="
        },
        {
            "version_value": "4.0",
            "operator": "="
        }
    ],
    "references": [
        "https://github.com/zopefoundation/AccessControl/commit/b42dd4badf803bb9fb71ac34cd9cb0c249262f2c",
        "https://github.com/zopefoundation/AccessControl/blob/master/CHANGES.rst#51-2021-07-30",
        "https://github.com/advisories/GHSA-qcx9-j53g-ccgf",
        "https://github.com/zopefoundation/AccessControl/security/advisories/GHSA-qcx9-j53g-ccgf",
        "https://nvd.nist.gov/vuln/detail/CVE-2021-32807"
    ],
    "description": "From NVD:\nThe module `AccessControl` defines security policies for Python code used in restricted code within Zope applications. Restricted code is any code that resides in Zope's object database, such as the contents of `Script (Python)` objects. The policies defined in `AccessControl` severely restrict access to Python modules and only exempt a few that are deemed safe, such as Python's `string` module. However, full access to the `string` module also allows access to the class `Formatter`, which can be overridden and extended within `Script (Python)` in a way that provides access to other unsafe Python libraries. Those unsafe Python libraries can be used for remote code execution. By default, you need to have the admin-level Zope \"Manager\" role to add or edit `Script (Python)` objects through the web. Only sites that allow untrusted users to add/edit these scripts through the web - which would be a very unusual configuration to begin with - are at risk. The problem has been fixed in AccessControl 4.3 and 5.2. Only AccessControl versions 4 and 5 are vulnerable, and only on Python 3, not Python 2.7. As a workaround, a site administrator can restrict adding/editing `Script (Python)` objects through the web using the standard Zope user/role permission mechanisms. Untrusted users should not be assigned the Zope Manager role and adding/editing these scripts through the web should be restricted to trusted users only. This is the default configuration in Zope.\nFrom Github:\n### Impact\nThe module `AccessControl` defines security policies for Python code used in restricted code within Zope applications. Restricted code is any code that resides in Zope's object database, such as the contents of `Script (Python)` objects. \n\nThe policies defined in `AccessControl` severely restrict access to Python modules and only exempt a few that are deemed safe, such as Python's `string` module. However, full access to the `string` module also allows access to the class `Formatter`, which can be overridden and extended within `Script (Python)` in a way that provides access to other unsafe Python libraries. Those unsafe Python libraries can be used for remote code execution.\n\nBy default, you need to have the admin-level Zope \"Manager\" role to add or edit `Script (Python)` objects through the web. Only sites that allow untrusted users to add/edit these scripts through the web - which would be a very unusual configuration to begin with - are at risk.\n\n### Patches\nThe problem has been fixed in AccessControl 4.3 and 5.2.\nOnly AccessControl versions 4 and 5 are vulnerable, and only on Python 3, not Python 2.7.\n\n### Workarounds\nA site administrator can restrict adding/editing `Script (Python)` objects through the web using the standard Zope user/role permission mechanisms. Untrusted users should not be assigned the Zope Manager role and adding/editing these scripts through the web should be restricted to trusted users only. This is the default configuration in Zope.\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in the [AccessControl issue tracker](https://github.com/zopefoundation/AccessControl/issues)\n* Email us at [security@plone.org](mailto:security@plone.org)\n",
    "latest_version": "5.2",
    "language": "python",
    "license": "ZPL-2.1",
    "repository_summary": "Security framework for Zope.",
    "repo_url": "https://github.com/zopefoundation/AccessControl",
    "impact": {
        "cvss2_score": null,
        "cvss2_severity": null,
        "av": "NETWORK",
        "ac": "HIGH",
        "pr": "HIGH",
        "c": "HIGH",
        "i": "HIGH",
        "a": "HIGH",
        "impact_score": 5.9,
        "exploitability_score": 0.7,
        "cvss3_score": 6.6,
        "cvss3_severity": "MEDIUM",
        "ui": "NONE",
        "s": "UNCHANGED",
        "vector_string": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H"
    },
    "ochrona_severity_score": 6.6
}