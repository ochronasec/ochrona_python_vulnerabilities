{
    "name": "onionshare-cli",
    "cve_id": "CVE-2022-21695",
    "publish_date": "2022-01-18T22:15Z",
    "cwe_id": "CWE-287",
    "owner": "Micah Lee",
    "affected_versions": [
        {
            "version_value": "2.5",
            "operator": "<"
        }
    ],
    "references": [
        "https://github.com/onionshare/onionshare/security/advisories/GHSA-99p8-9p2c-49j4",
        "https://github.com/onionshare/onionshare/releases/tag/v2.5",
        "https://nvd.nist.gov/vuln/detail/CVE-2022-21695",
        "https://github.com/advisories/GHSA-99p8-9p2c-49j4"
    ],
    "description": "From NVD:\nOnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions authenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants. This issue has been resolved in version 2.5.\nFrom Github:\nBetween September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-009\n- Vulnerability type: Improper Access Control\n- Threat level: Low\n\n## Description:\n\nAuthenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants.\n\n## Technical description:\n\nPrerequisites:\n\n- Existing chatroom\n- Access to the chatroom (Public or known Private Key)\n- Either a modified frontend client or manual requests from burp/curl\n\nIf a user opens the chatroom without emitting the join message he will not be present in session.users[x] list. Therefore there is no listing in the frontend and no chat participant knows another party joined the chat. It is still possible to send messages in the chatroom.\n\nIf a user decides to abuse OTF-003 (page 22) he can impersonate messages from existing users; others would not be able to distinguish original and faked messages. This is also a prerequisite for OTF-004 (page 19).\n\n## Impact:\n\nAn adversary with access to the chat environment can send messages to the chat without being visible in the list of chat participants.\n\n## Recommendation:\n\n- Allow chat access only after emission of the join event.\n- Implement proper session handling.",
    "latest_version": "2.5",
    "language": "python",
    "license": "GPL-3.0-or-later",
    "repository_summary": "OnionShare lets you securely and anonymously send and receive files. It works by starting a web server, making it accessible as a Tor onion service, and generating an unguessable web address so others can download files from you, or upload files to you. It does _not_ require setting up a separate server or using a third party file-sharing service.",
    "repo_url": "https://github.com/onionshare/onionshare",
    "impact": {
        "cvss2_score": 5.0,
        "cvss2_severity": "MEDIUM",
        "vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
        "av": "NETWORK",
        "ac": "LOW",
        "pr": "NONE",
        "c": "NONE",
        "i": "LOW",
        "a": "NONE",
        "impact_score": 1.4,
        "exploitability_score": 3.9,
        "cvss3_score": 5.3,
        "cvss3_severity": "MEDIUM",
        "ui": "NONE",
        "s": "UNCHANGED"
    },
    "ochrona_severity_score": 5.3
}