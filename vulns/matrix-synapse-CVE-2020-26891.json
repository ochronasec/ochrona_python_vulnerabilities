{
    "name": "matrix-synapse",
    "cve_id": "CVE-2020-26891",
    "publish_date": "2020-10-19T17:15Z",
    "cwe_id": "CWE-79",
    "owner": "Matrix Authors",
    "affected_versions": [
        {
            "version_value": "1.21.0",
            "operator": "<"
        }
    ],
    "references": [
        "https://nvd.nist.gov/vuln/detail/CVE-2020-26891",
        "https://github.com/advisories/GHSA-3x8c-fmpc-5rmq",
        "https://matrix.org/blog/2020/10/15/synapse-1-21-2-released-and-security-advisory",
        "https://github.com/matrix-org/synapse/security/advisories/GHSA-3x8c-fmpc-5rmq",
        "https://github.com/matrix-org/synapse/pull/8444",
        "https://github.com/matrix-org/synapse/releases/tag/v1.21.2"
    ],
    "description": "From NVD:\nAuthRestServlet in Matrix Synapse before 1.21.0 is vulnerable to XSS due to unsafe interpolation of the session GET parameter. This allows a remote attacker to execute an XSS attack on the domain Synapse is hosted on, by supplying the victim user with a malicious URL to the /_matrix/client/r0/auth/*/fallback/web or /_matrix/client/unstable/auth/*/fallback/web Synapse endpoints.\nFrom Github:\n### Impact\nThe fallback authentication endpoint served via Synapse were vulnerable to cross-site scripting (XSS) attacks. The impact depends on the configuration of the domain that Synapse is deployed on, but may allow access to cookies and other browser data, CSRF vulnerabilities, and access to other resources served on the same domain or parent domains.\n\n### Patches\nThis is fixed by #8444, which is included in Synapse v1.21.0.\n\n### Workarounds\nIf the homeserver is not configured to use reCAPTCHA, consent (terms of service), or single sign-on then the affected endpoint can be blocked at a reverse proxy:\n\n* `/_matrix/client/r0/auth/.*/fallback/web`\n* `/_matrix/client/unstable/auth/.*/fallback/web`",
    "latest_version": "1.22.1",
    "language": "python",
    "license": "Apache-2.0",
    "repository_summary": "Reference homeserver for the Matrix decentralised comms protocol",
    "repo_url": "https://github.com/matrix-org/synapse",
    "impact": {
        "cvss2_score": 4.3,
        "cvss2_severity": "MEDIUM",
        "vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
        "av": "NETWORK",
        "ac": "LOW",
        "pr": "NONE",
        "c": "LOW",
        "i": "LOW",
        "a": "NONE",
        "impact_score": 2.7,
        "exploitability_score": 2.8,
        "cvss3_score": 6.1,
        "cvss3_severity": "MEDIUM",
        "ui": "REQUIRED",
        "s": "CHANGED"
    },
    "ochrona_severity_score": 6.1
}