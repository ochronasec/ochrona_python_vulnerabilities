{
    "name": "Products.isurlinportal",
    "cve_id": "CVE-2021-32806",
    "publish_date": "2021-08-02T19:15Z",
    "cwe_id": "CWE-601",
    "owner": "Plone Security Team",
    "affected_versions": [
        {
            "version_value": "1.2.0",
            "operator": "<"
        }
    ],
    "references": [
        "https://nvd.nist.gov/vuln/detail/CVE-2021-32806",
        "https://github.com/plone/Products.isurlinportal/security/advisories/GHSA-q3m9-9fj2-mfwr",
        "https://github.com/plone/Products.isurlinportal/commit/d4fd34990d18adf05a10dc5e2bb4b066798280ba",
        "https://github.com/advisories/GHSA-q3m9-9fj2-mfwr"
    ],
    "description": "From NVD:\nProducts.isurlinportal is a replacement for isURLInPortal method in Plone. Versions of Products.isurlinportal prior to 1.2.0 have an Open Redirect vulnerability. Various parts of Plone use the 'is url in portal' check for security, mostly to see if it is safe to redirect to a url. A url like `https://example.org` is not in the portal. The url `https:example.org` without slashes is considered to be in the portal. When redirecting, some browsers go to `https://example.org`, others give an error. Attackers may use this to redirect victims to their site, especially as part of a phishing attack. The problem has been patched in Products.isurlinportal 1.2.0.\nFrom Github:\n### Impact\nVarious parts of Plone use the 'is url in portal' check for security, mostly to see if it is safe to redirect to a url. A url like `https://example.org` is not in the portal.\nBut the url `https:example.org` without slashes tricks our code and it _is_ considered to be in the portal.\nWhen redirecting, some browsers go to `https://example.org`, others give an error.\nAttackers may use this to redirect you to their site, especially as part of a phishing attack.\n\n### Patches\nThe problem has been patched in `Products.isurlinportal` 1.2.0.\nThis is a recommended upgrade for all users of Plone 4.3 and 5, on Python 2.7 or higher.\nIt has not been tested on earlier Plone or Python versions.\nUpcoming Plone 5.2.5 and higher will include the new version.\n\n### Discovered\nThis vulnerability was discovered and reported by Yuji Tounai of Mitsui Bussan Secure Directions, Inc. Thank you!\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email the Plone Security Team at [security@plone.org](mailto:security@plone.org), especially when you think you have discovered a security problem or when you are not sure.\n* Open an issue in [the tracker](https://github.com/plone/Products.isurlinportal/issues) if your question or comment can be public.\n",
    "latest_version": "1.2.0",
    "language": "python",
    "license": "GPL-1.0-only",
    "repository_summary": "Replacement for isURLInPortal method in Plone",
    "repo_url": "https://github.org/plone/Products.isurlinportal",
    "impact": {
        "cvss2_score": null,
        "cvss2_severity": null,
        "av": "NETWORK",
        "ac": "LOW",
        "pr": "NONE",
        "c": "NONE",
        "i": "HIGH",
        "a": "NONE",
        "impact_score": 3.6,
        "exploitability_score": 2.8,
        "cvss3_score": 6.5,
        "cvss3_severity": "MEDIUM",
        "ui": "REQUIRED",
        "s": "UNCHANGED",
        "vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N"
    },
    "ochrona_severity_score": 6.5
}