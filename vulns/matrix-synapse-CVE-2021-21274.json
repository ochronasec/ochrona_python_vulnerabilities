{
    "name": "matrix-synapse",
    "cve_id": "CVE-2021-21274",
    "publish_date": "2021-02-26T18:15Z",
    "cwe_id": "CWE-400",
    "owner": "Matrix Authors",
    "affected_versions": [
        {
            "version_value": "1.25.0",
            "operator": "<"
        }
    ],
    "references": [
        "https://github.com/matrix-org/synapse/pull/8950",
        "https://github.com/advisories/GHSA-2hwx-mjrm-v3g8",
        "https://github.com/matrix-org/synapse/releases/tag/v1.25.0",
        "https://github.com/matrix-org/synapse/security/advisories/GHSA-2hwx-mjrm-v3g8",
        "https://nvd.nist.gov/vuln/detail/CVE-2021-21274",
        "https://github.com/matrix-org/synapse/commit/ff5c4da1289cb5e097902b3e55b771be342c29d6"
    ],
    "description": "From NVD:\nSynapse is a Matrix reference homeserver written in python (pypi package matrix-synapse). Matrix is an ecosystem for open federated Instant Messaging and VoIP. In Synapse before version 1.25.0, a malicious homeserver could redirect requests to their .well-known file to a large file. This can lead to a denial of service attack where homeservers will consume significantly more resources when requesting the .well-known file of a malicious homeserver. This affects any server which accepts federation requests from untrusted servers. Issue is resolved in version 1.25.0. As a workaround the `federation_domain_whitelist` setting can be used to restrict the homeservers communicated with over federation.\nFrom Github:\n### Impact\nA malicious homeserver could redirect requests to their .well-known file to a large file. This can lead to a denial of service attack where homeservers will consume significantly more resources when requesting the .well-known file of a malicious homeserver.\n\nThis affects any server which accepts federation requests from untrusted servers.\n\n### Patches\nIssue is resolved by #8950. A bug not affecting the security aspects of this was fixed in #9108.\n\n### Workarounds\nThe `federation_domain_whitelist` setting can be used to restrict the homeservers communicated with over federation.",
    "latest_version": "1.29.0",
    "language": "python",
    "license": "Apache-2.0",
    "repository_summary": "Reference homeserver for the Matrix decentralised comms protocol",
    "repo_url": "https://github.com/matrix-org/synapse",
    "impact": {
        "cvss2_score": 4.3,
        "cvss2_severity": "MEDIUM",
        "vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
        "av": "NETWORK",
        "ac": "LOW",
        "pr": "NONE",
        "c": "NONE",
        "i": "NONE",
        "a": "HIGH",
        "impact_score": 3.6,
        "exploitability_score": 2.8,
        "cvss3_score": 6.5,
        "cvss3_severity": "MEDIUM",
        "ui": "REQUIRED",
        "s": "UNCHANGED"
    },
    "ochrona_severity_score": 6.5
}